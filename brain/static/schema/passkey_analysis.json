{
    "type": "object",
    "title": "Passkey Analysis",
    "description": "Deep analysis of passkey implementation including WebAuthn parameters, virtual authenticator capture, and implementation details",
    "properties": {
        "scan_config": {
            "type": "object",
            "title": "Scan Configuration",
            "oneOf": [
                {
                    "title": "Single domain",
                    "properties": {
                        "scan_id": {
                            "type": "string",
                            "required": true,
                            "default": "",
                            "options": {"hidden": true}
                        },
                        "scan_type": {
                            "type": "string",
                            "required": true,
                            "enum": ["single"],
                            "options": {"hidden": true}
                        },
                        "domain": {
                            "type": "string",
                            "required": true,
                            "title": "Domain"
                        }
                    }
                },
                {
                    "title": "Range of domains",
                    "properties": {
                        "scan_id": {
                            "type": "string",
                            "required": true,
                            "default": "",
                            "options": {"hidden": true}
                        },
                        "scan_type": {
                            "type": "string",
                            "required": true,
                            "enum": ["range"],
                            "options": {"hidden": true}
                        },
                        "list_id": {
                            "type": "string",
                            "required": true,
                            "title": "List ID"
                        },
                        "offset": {
                            "type": "integer",
                            "required": true,
                            "default": 1,
                            "title": "Offset"
                        },
                        "limit": {
                            "type": "integer",
                            "required": true,
                            "default": 100,
                            "title": "Limit"
                        }
                    }
                }
            ]
        },
        "passkey_analysis_config": {
            "type": "object",
            "title": "Configuration",
            "properties": {
                "browser_config": {
                    "type": "object",
                    "required": true,
                    "title": "Browser",
                    "properties": {
                        "name": {
                            "type": "string",
                            "required": true,
                            "default": "CHROMIUM",
                            "enum": ["CHROMIUM"]
                        },
                        "width": {
                            "type": "integer",
                            "required": true,
                            "default": 1920
                        },
                        "height": {
                            "type": "integer",
                            "required": true,
                            "default": 1080
                        },
                        "headless": {
                            "type": "boolean",
                            "required": true,
                            "default": true
                        },
                        "timeout_default": {
                            "type": "number",
                            "required": true,
                            "default": 30
                        }
                    }
                },
                "login_page_config": {
                    "type": "object",
                    "required": true,
                    "title": "Login Page Detection",
                    "properties": {
                        "login_page_strategy_scope": {
                            "type": "array",
                            "required": true,
                            "default": ["PATHS", "HOMEPAGE"],
                            "items": {
                                "type": "string",
                                "enum": ["PATHS", "CRAWLING", "METASEARCH", "HOMEPAGE", "SITEMAP", "ROBOTS", "MANUAL"]
                            }
                        }
                    }
                },
                "passkey_detection_config": {
                    "type": "object",
                    "required": true,
                    "title": "Passkey Detection",
                    "properties": {
                        "wait_time": {
                            "type": "number",
                            "required": true,
                            "title": "Wait Time (seconds)",
                            "default": 5
                        },
                        "attempt_trigger": {
                            "type": "boolean",
                            "required": true,
                            "title": "Attempt to Trigger WebAuthn",
                            "default": true
                        }
                    }
                },
                "artifacts_config": {
                    "type": "object",
                    "required": true,
                    "title": "Artifacts",
                    "properties": {
                        "store_passkey_screenshot": {
                            "type": "boolean",
                            "required": true,
                            "default": true
                        },
                        "store_passkey_har": {
                            "type": "boolean",
                            "required": true,
                            "default": true
                        }
                    }
                }
            }
        }
    }
}


